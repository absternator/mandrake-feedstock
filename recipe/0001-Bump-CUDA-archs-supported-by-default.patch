From ead7e95ddf0e7818481f91b029858389badeafaf Mon Sep 17 00:00:00 2001
From: John Lees <lees.john6@gmail.com>
Date: Wed, 20 Dec 2023 15:50:43 +0000
Subject: [PATCH] Bump CUDA archs supported by default

---
 CMakeLists.txt | 2 +-
 src/Makefile   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index d295916..cda30f4 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -46,7 +46,7 @@ if(CMAKE_CUDA_COMPILER)
     enable_language(CUDA)
     set(CUDA_OPTS "-Wreorder -Xcompiler -fPIC -Xcompiler -Wall -Xcompiler -fopenmp -Xptxas -dlcm=ca --cudart static --relocatable-device-code=false")
     if(NOT DEFINED CMAKE_CUDA_ARCHITECTURES)
-            set(CMAKE_CUDA_ARCHITECTURES 70 75 80 86)
+        set(CMAKE_CUDA_ARCHITECTURES 80 86 90)
     endif()
     if(CMAKE_BUILD_TYPE MATCHES Debug)
         string(APPEND CUDA_OPTS " -G")
diff --git a/src/Makefile b/src/Makefile
index 4ce170d..70d5ac2 100644
--- a/src/Makefile
+++ b/src/Makefile
@@ -22,7 +22,7 @@ PYTHON_LIB = SCE$(shell python3-config --extension-suffix)
 ifdef GENARCH
 	GENCODE=${GENARCH}
 else
-	GENCODE=-gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75  -gencode arch=compute_80,code=sm_80 -gencode arch=compute_86,code=sm_86
+	GENCODE=-gencode arch=compute_80,code=sm_80 -gencode arch=compute_86,code=sm_86 -gencode arch=compute_90,code=sm_90
 endif
 CUDA_LDFLAGS =-L$(LIBLOC)/lib -L${CUDA_HOME}/targets/x86_64-linux/lib/stubs -L${CUDA_HOME}/targets/x86_64-linux/lib
 CUDAFLAGS +=-Xcompiler -fPIC -Xptxas -dlcm=ca --cudart static --relocatable-device-code=true $(GENCODE)
-- 
2.39.3 (Apple Git-145)

